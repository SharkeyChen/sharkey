(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-01a041e6"],{3667:function(t,s,i){"use strict";var e=i("f495"),a=i.n(e);a.a},be06:function(t,s,i){"use strict";i.r(s);var e=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",[i("div",{staticStyle:{float:"left"}},[i("el-card",{staticClass:"box-card"})],1),i("div",{staticClass:"boardleft"},[i("div",{staticClass:"drawBoard"},[i("div",{staticClass:"canvasSetting"},[i("span",[t._v("选择颜色")]),i("br"),i("el-color-picker",{on:{change:t.changeColor},model:{value:t.drawColor,callback:function(s){t.drawColor=s},expression:"drawColor"}}),i("br"),i("span",[t._v("粗细")]),i("el-slider",{attrs:{step:1,min:1,max:10},on:{change:t.changeLineWidth},model:{value:t.drawLineWidth,callback:function(s){t.drawLineWidth=s},expression:"drawLineWidth"}}),i("br")],1),i("canvas",{ref:"canvas",attrs:{id:"drawBoard",width:"1000",height:"500"},on:{click:t.draw}}),i("br"),i("el-button",{staticClass:"clearButton",on:{click:t.clearCanvas}},[t._v("clear")]),i("el-button",{on:{click:t.clickReady}},[t._v("准备")])],1)]),i("div",{staticClass:"boardright"},[i("div",{staticClass:"totalBoard",attrs:{id:"totalBoard"}},[t._l(t.chatRecords,(function(s,e){return i("div",{key:e,staticClass:"record"},[i("span",{staticClass:"blue"},[t._v(t._s(s.username))]),t._v(":"+t._s(s.content)+" ")])})),i("div",{staticClass:"blank"})],2),i("div",[i("input",{directives:[{name:"model",rawName:"v-model",value:t.guessWord,expression:"guessWord"}],staticClass:"inputContent",attrs:{type:"text",placeholder:"这里输入内容",component:"inputBoard"},domProps:{value:t.guessWord},on:{keydown:function(s){return!s.type.indexOf("key")&&t._k(s.keyCode,"enter",13,s.key,"Enter")?null:t.submitWord(s)},input:function(s){s.target.composing||(t.guessWord=s.target.value)}}}),i("el-button",{staticClass:"submitButton",attrs:{type:"primary",component:"inputBoard"},on:{click:t.submitWord}},[t._v("发送")])],1)]),i("div",[t.playerList?i("el-table",{attrs:{data:t.playerList}},[i("el-table-column",{attrs:{label:"头像"},scopedSlots:t._u([{key:"default",fn:function(s){return[i("el-avatar",{key:t.stcImg+s.row.profile,attrs:{fit:"fill",src:t.stcImg+s.row.profile}})]}}],null,!1,2111346685)}),i("el-table-column",{attrs:{prop:"nickname",label:"昵称"}}),i("el-table-column",{attrs:{prop:"status",label:"状态",formatter:t.stateFormat}})],1):t._e()],1)])},a=[],r=(i("e35a"),i("0d7a"),i("e769")),n={name:"GuessDraw",data:function(){return{drawColor:"#000000",drawLineWidth:1,lineEndType:"默认",param:{},roomid:"",user:{},canvas:{},ctx:{},stage_info:{},path:{},isDraw:!1,playerList:[],stcImg:this.$StaticImage,drawAble:!1,keyword:"",chatRecords:[],guessWord:""}},mounted:function(){this.init(),this.getUserInfo()},methods:{init:function(){this.canvas=this.$refs.canvas,console.log(this.ctx+"YES"),this.ctx=this.canvas.getContext("2d"),console.log(this.ctx+"NO"),this.stage_info=this.canvas.getBoundingClientRect(),this.path={beginX:0,beginY:0,endX:0,endY:0},this.isDraw=!1,this.roomid=window.location.href.split("=")[1],this.draw()},stateFormat:function(t,s){return 0==t.status?"未准备":1==t.status?"已准备":2==t.status?"正在画画":3==t.status?"正在猜":void 0},clickReady:function(){this.setParam(1002,{rid:this.roomid,id:this.user.username}),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param))},submitWord:function(){if(this.guessWord&&""!=this.guessWord){var t={rid:this.roomid,username:this.user.username,content:this.guessWord,status:"chat"};this.setParam(1004,t),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param)),this.guessWord=""}},changeColor:function(t){if(this.drawAble){this.ctx.strokeStyle=t;var s={rid:this.roomid,status:"changeColor",id:this.user.username,color:t};this.setParam(1004,s),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param))}},changeLineWidth:function(t){if(this.drawAble){this.ctx.lineWidth=t;var s={rid:this.roomid,status:"changeLineWidth",id:this.user.username,lineWidth:t};this.setParam(1004,s),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param))}},clearCanvas:function(){if(this.drawAble){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);var t={rid:this.roomid,status:"clear",id:this.user.username};this.setParam(1004,t),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param))}},draw:function(){var t=this;t.canvas.onmousedown=function(s){if(1==t.drawAble){t.ctx.beginPath(),t.path.beginX=s.pageX-t.stage_info.left,t.path.beginY=s.pageY-t.stage_info.top,t.ctx.moveTo(t.path.beginX,t.path.beginY),t.isDraw=!0;var i={rid:t.roomid,status:"begin",id:t.user.username};t.setParam(1004,i),t.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(t.param))}},t.canvas.onmousemove=function(s){t.drawAble&&t.isDraw&&t.drawing(s)},t.canvas.onmouseup=function(s){if(t.drawAble){t.isDraw=!1;var i={rid:t.roomid,status:"end",id:t.user.username};t.setParam(1004,i),t.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(t.param))}}},drawing:function(t){this.path.endX=t.pageX-this.stage_info.left,this.path.endY=t.pageY-this.stage_info.top,this.ctx.lineTo(this.path.endX,this.path.endY),this.ctx.stroke();var s={sx:this.path.beginX,sy:this.path.beginY,ex:this.path.endX,ey:this.path.endY,rid:this.roomid,status:"drawing",id:this.user.username};this.setParam(1004,s),this.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(this.param)),this.path.beginX=this.path.endX,this.path.beginY=this.path.endY},drawLine:function(t,s,i,e){this.ctx.moveTo(t,s),this.ctx.lineTo(i,e),this.ctx.stroke()},getUserInfo:function(){var t=this,s=window.sessionStorage.getItem("user");if(null==s)return window.sessionStorage.removeItem("user"),void this.$router.push("/");var i="/user/?username="+s;this.getRequest(i).then((function(s){t.user=s;var i={id:t.user.username,rid:t.roomid};t.setParam(1e3,i),t.$ws.dispatch("WEBSOCKET_SEND",JSON.stringify(t.param))}))},setParam:function(t,s){for(var i in this.param={},this.param.code=t,s)this.param[i]=s[i]},isJSON:function(t){if("string"!=typeof t)return!1;try{var s=JSON.parse(t);return!("object"!=Object(r["a"])(s)||!s)}catch(i){return console.log("error："+t+"!!!"+i),!1}}},computed:{alertCon:function(){return this.$ws.getters.onEvent("string")}},watch:{drawColor:function(){this.draw.changeColor(this.drawColor)},drawLineWidth:function(){this.draw.changeLineWidth(this.drawLineWidth)},alertCon:function(t,s){var i=this;if(t!=s&&(console.log(t),this.isJSON(t))){var e=JSON.parse(t);if(1001==e.code){var a=e.players,r="/user/getUsers";this.postRequest(r,a).then((function(t){i.playerList=t.data;for(var s=0;s<i.playerList.length;s++)i.playerList[s]["status"]=0}))}else if(1002==e.code)for(var n=0;n<this.playerList.length;n++)this.playerList[n].username===e.id&&(this.playerList[n].status=1,this.$set(this.playerList,n,this.playerList[n]));else if(1003==e.code){var o=e.painter;this.keyword=e.keyword,o==this.user.username?this.drawAble=!0:this.drawAble=!1;for(var h=0;h<this.playerList.length;h++)this.playerList[h].username===o?this.playerList[h].status=2:this.playerList[h].status=3,this.$set(this.playerList,h,this.playerList[h])}else if(1004==e.code&&e.id!==this.user.username)if("begin"===e.status)this.isDraw=!0;else if("end"===e.status)this.isDraw=!1;else if("drawing"===e.status){var d=e.sx,c=e.sy,l=e.ex,u=e.ey;this.drawLine(d,c,l,u)}else if("changeColor"===e.status){var p=e.color;this.drawColor=p,this.ctx.strokeStyle=p}else if("changeLineWidth"===e.status){var f=e.lineWidth;this.drawLineWidth=f,this.ctx.lineWidth=f}else if("clear"===e.status)this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);else if("chat"===e.status){var m={username:e.username};console.log(JSON.stringify(e)),console.log(this.keyword),e.content===this.keyword?m["content"]="答对了(#^.^#)":m["content"]=this.keyword,this.chatRecords.push(m)}}}}},o=n,h=(i("3667"),i("4023")),d=Object(h["a"])(o,e,a,!1,null,"3e39a147",null);s["default"]=d.exports},f495:function(t,s,i){}}]);
//# sourceMappingURL=chunk-01a041e6.0c04845a.js.map